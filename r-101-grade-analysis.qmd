---
title: "r-101-grade-analysis"
author: "Victoire Truchon-Bart√®s"
format: html
editor: visual
---

## 

```{r}
here::i_am("r-101-grade-analysis.Rproj")
#| message: false
library(here)
library(dplyr)
library(ggplot2)
library(tidyr)
```

*Question 1*

```{r}
#| message: false
here::i_am("grades.csv")
library(readr)
grades_2_ <- read_csv("grades.csv")

```

*Question 2*

```{r}
exam_summary <- grades_2_ %>%
  summarise(
    "Minimum" = min(Exam, na.rm = TRUE),
    "Maximum" = max(Exam, na.rm = TRUE),
    "Median" = median(Exam, na.rm = TRUE),
    "Mean" = mean(Exam, na.rm = TRUE),
  )

# Render the summary table using knitr::kable
knitr::kable(exam_summary, format = "markdown")
```

*Question 3*

```{r}
num_missing_exam <- sum(is.na(grades_2_$Exam))

cat("The number of students who did not take the final exam is", num_missing_exam)
```

*Question 4*

```{r}
ggplot(grades_2_, aes(x = Exam, fill = ..count..)) +
  geom_histogram(binwidth = 1, color = "black") +
  labs(title = "Distribution of grades at the Exam",
       x = "Exam Grade",
       y = "Frequency") +
  scale_fill_gradient(low = "lightgreen", high = "darkgreen") +
  theme_minimal()
```

*Question 5*

```{r}
group_counts <- grades_2_ %>%
  group_by(Group) %>%
  summarise(Count = n())


# include the table using knitr::kable
knitr::kable(group_counts, format = "markdown")
```

*Question 6*

```{r}
ggplot(group_counts, aes(x = Group, y = Count)) +
  geom_bar(stat = "identity", fill = "red") +
  labs(title = "Number of Students in Each Group",
       x = "Group",
       y = "Number of student") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 50, hjust = 1))


```

*Question 7*

```{r}
# Option 1: Boxplot
ggplot(grades_2_, aes(x = Group, y = Exam)) +
  geom_boxplot(fill = "blue") +
  labs(title = "Distribution of Exam Grades by Group (Boxplot)",
       x = "Group",
       y = "Exam Grade") +
  theme_minimal()+
    theme(axis.text.x = element_text(angle = 50, hjust = 1))
  

# Option 2: Point 

ggplot(grades_2_, aes(x = Group, y = Exam)) +
  geom_point(fill = "lightblue") +
  labs(title = "Distribution of Exam Grades by Group (point Plot)",
       x = "Group",
       y = "Exam Grade") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 50, hjust = 1))

```

*Question 8*

```{r}
missed_exam_counts <- grades_2_ %>%
  group_by(Group) %>%
  summarise(Missed_Exam = sum(is.na(Exam)))

missed_exam_counts

```

*Question 9*

```{r}
ggplot(missed_exam_counts, aes(x = Group, y = Missed_Exam)) +
  geom_col(fill = "cyan") +
  labs(title = "Number of Students Who Missed the Exam by Group",
       x = "Group",
       y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 50, hjust = 1))
```

*Question 10*

```{r}
long <- grades_2_ %>%
  pivot_longer( cols = c(matches("MCQ"), Exam), 
    names_to = "name",
    values_to = "value")
```

*Question 11*

```{r}
missing_grades_per_student <- long %>%
  group_by(Id) %>%
  summarise(Total_Missing_Grades = sum(is.na(value)))


```

*Question 12*

```{r}

 ggplot(missing_grades_per_student, aes(x = Total_Missing_Grades, fill = ..count..)) +
  geom_histogram(color = "blue")+ 
  labs(title = "Distribution of total missing grades per student",
       x = "Total missing grades", 
       y = "Frequency") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") + 
  theme_minimal()

```

*Question 13*

```{r}
missed_exam_counts_long <- long %>%
  filter(name == "Exam" & is.na(value)) %>%
  group_by(Group) %>%
  summarise(Missed_Exam = sum(is.na(value)))

knitr::kable(missed_exam_counts_long)
```

*Question 14*

```{r}
library(stringr)
missing_online_test_grades_per_student <- long %>%
  filter(str_starts(name, "Online_MCQ_") & is.na(value)) %>%
  group_by(Id) %>%
  summarise(Missing_Online_Test_Grades = sum(is.na(value)))
```

*Question 16*

```{r}
missed_mcq_data <- long %>%
    group_by(Id)%>%
  filter(str_starts(name, "MCQ_"))%>%
  select(Id,value)%>%
  group_by(Id)%>%
  summarise(miss=anyNA(value))

missed_mcq_data

```

*Question 17*

```{r}
percentage_missed_per_group <- long %>%

  filter(str_starts(name, "MCQ")) %>%
  group_by(Group) %>%
  summarize(P_missed = mean(is.na(value)) * 100)

# Render the table using knitr::kable
knitr::kable(percentage_missed_per_group)

```

*Question 18*

```{r}
# Calculate average exam grades per group
average_exam_grades_per_group <- grades_2_ %>%
  group_by(Group) %>%
  summarize(Average_Exam_Grade = mean(Exam, na.rm = TRUE))

# Merge the two tables using inner_join
merged_data <- inner_join(average_exam_grades_per_group, percentage_missed_per_group, by = "Group")

# Scatter plot
ggplot(merged_data, aes(x = P_missed, y = Average_Exam_Grade, color = Group)) +
  geom_point() +
  labs(title = "Average Exam Grade vs. Percentage of Missed MCQ_xx Grades",
       x = "Percentage",
       y = "Average Exam grade",
       color = "Group")+
      theme_minimal()
```
